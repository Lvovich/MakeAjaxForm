(function(){'use strict';window.MakeAjaxForm=function(a){if("object"!==typeof this||this===window)return console.error('makeAjaxForm: incorrect call without "new". Plugin Off!'),{};a.target=""+a.target||"/";if(!a.container||!a.submit)return console.error('makeAjaxForm: parameters "container" or "submit" is invalid. Plugin Off!'),{};"function"!==typeof a.onBeforeExchange&&(a.onBeforeExchange=function(){});"function"!==typeof a.onExchangeSuccess&&(a.onExchangeSuccess=function(){console.warn('makeAjaxForm: parameter "onExchangeSuccess" is not a function')});
"function"!==typeof a.onExchangeError&&(a.onExchangeError=function(){console.warn('makeAjaxForm: parameter "onExchangeError" is not a function')});"function"!==typeof a.onValidationError&&(a.onValidationError=function(){console.warn('makeAjaxForm: parameter "onValidationError" is not a function')});return function(c,e){c.i=a.container;c.h=a.submit;c.h.addEventListener("click",function(){var b=new XMLHttpRequest,d=e.j(c),g=e.m(d,a);if(!1===g)return!1;var f=setTimeout(function(){b.abort();a.onExchangeError("No server response for a long times. Exchange aborted. Try to reload the page.")},
3E4);b.open("post",a.target,!0);b.onreadystatechange=function(){if(4==b.readyState)if(clearTimeout(f),200==b.status)a.onExchangeSuccess(b.responseText);else a.onExchangeError(b.status+": "+b.statusText)};d=e.l(d,g.formData,a);d.f.length&&b.setRequestHeader("Content-Type","multipart/form-data; boundary="+d.f);b.send(d.data)})}(this,window.MakeAjaxForm)};(function(a){a.a=Object.create(null);a.a.c=function(c,a){var b=Object.create(null);b.element=c;b.type=a;return b};a.a.b=function(c,a,b){b=b||[];var d=Object.create(null);d.name=c;d.value=a;d.g=b;return d};a.a.input=function(c){var a=[],b=[];c.value?"checkbox"===c.type||"radio"===c.type?c.checked?a.push(this.b(c.name,c.value)):c.hasAttribute("required")&&b.push(this.c(c,"required_wo_check")):"file"===c.type?a.push(this.b(c.name,c.value,c.files)):a.push(this.b(c.name,c.value)):c.hasAttribute("required")&&
b.push(this.c(c,"required_wo_value"));return{data:a,valid:b}};a.a.select=function(c){for(var a=[],b=[],d=0,g=c.options.length;d<g;d++){var f=c.options[d];!f.disabled&&f.selected&&f.value&&a.push(this.b(c.name,f.value))}c.hasAttribute("required")&&!a.length&&b.push(this.c(c,"required_wo_check"));return{data:a,valid:b}};a.a.textarea=function(a){var e=[],b=[];a.value?e.push(this.b(a.name,a.value)):a.hasAttribute("required")&&b.push(this.c(a,"required_wo_value"));return{data:e,valid:b}}})(window.MakeAjaxForm);(function(a){a.j=function(c){var e=[],b=[];["input","select","textarea"].forEach(function(d){if(d in a.a)for(var g=c.i.querySelectorAll(d),f=0,k=g.length;f<k;f++){var h=g[f];h!==c.h&&h.name&&(h=a.a[d](h),e=e.concat(h.data),b=b.concat(h.valid))}});return{data:e,validationErrors:b}}})(window.MakeAjaxForm);(function(a){a.m=function(a,e){var b=Object.create(null);if(!1===e.onBeforeExchange(a))return!1;if(0<a.validationErrors.length)return a.validationErrors.forEach(function(a){e.onValidationError(a)}),!1;if(0===a.data.length)return e.onExchangeError("no_valid_data"),!1;b.formData=window.FormData?new FormData:!1;return b}})(window.MakeAjaxForm);(function(a){a.l=function(a,e,b){var d=Object.create(null);if(e)a.data.forEach(function(a){e.append(a.name,a.g.length?a.g[0]:a.value)}),d.f="",d.data=e;else{var g="maf"+(""+Math.random()).slice(2,18),f="--"+g+"\r\n",k="--"+g+"--\r\n",h=["\r\n"];a.data.forEach(function(a){if(a.g.length)b.onExchangeError("file_exchange_disabled");else h.push('Content-Disposition: form-data; name="'+a.name+'"\r\n\r\n'+a.value+"\r\n")});d.f=g;d.data=h.join(f)+k}return d}})(window.MakeAjaxForm);})();
