/**
 * @file makeAjaxForm
 * @version 5.0
 *
 * @author Lvovich
 * @see {@link https://github.com/Lvovich/makeAjaxForm|GitHub}
 *
 * @license MIT
 */
'use strict';try{window.makeAjaxForm=function(a){if(a.container&&"object"===typeof a.container&&a.submit&&"object"===typeof a.submit){var b=window.makeAjaxForm;a=b.j({g:a.container,submit:a.submit,target:""+a.target||"/",v:+a.waitingtime?+a.waitingtime:3600,s:void 0!==a.stopOnInvalid?!!a.stopOnInvalid:!0,onDataCollected:function(){},onValidationError:function(){},onStartExchange:function(){},onExchangeError:function(){},onExchangeSuccess:function(){}},{onDataCollected:a.onDataCollected,onValidationError:a.onValidationError,
onStartExchange:a.onStartExchange,onExchangeError:a.onExchangeError,onExchangeSuccess:a.onExchangeSuccess});b.o(a.submit,{handleEvent:b.u,m:a})}else console.error('makeAjaxForm: parameters "container" or "submit" is invalid. Plugin Off!')},function(a){a.a={};a.a.input=function(b){var e=[],c=[];!b.hasAttribute("required")||b.value&&!b.disabled?"checkbox"===b.type||"radio"===b.type?b.checked?e.push(a.b(b)):b.hasAttribute("required")&&c.push(a.c(b,"required_wo_check")):e.push(a.b(b)):c.push(a.c(b,"required_wo_value"));
return{data:e,valid:c}};a.a.select=function(b){var e=[],c=[],f;if(!b.disabled){for(f=0;f<b.options.length;f++){var d=b.options[f];!d.disabled&&d.selected&&d.value&&e.push(a.b(b))}b.hasAttribute("required")&&!e.length&&c.push(a.c(b,"required_wo_check"))}return{data:e,valid:c}};a.a.textarea=function(b){var e=[],c=[];!b.hasAttribute("required")||b.value&&!b.disabled?e.push(a.b(b)):c.push(a.c(b,"required_wo_value"));return{data:e,valid:c}}}(window.makeAjaxForm),function(a){a.h=function(b){var e=[],c=
[],f=["input","select","textarea"],d,g,k,l,h;for(d=0;d<f.length;d++)for(k=f[d],l=b.g.querySelectorAll(k),g=0;g<l.length;g++)h=l[g],h!==b.submit&&h.name&&(h=a.a[k](h),e=e.concat(h.data),c=c.concat(h.valid));return{data:e,validationErrors:c}}}(window.makeAjaxForm),function(a){a.i=function(b,a){var c={},f=window.FormData?new window.FormData:!1,d,g;if(f){for(d=0;d<b.data.length;d++)g=b.data[d],a=g.fileData.length?g.fileData[0]:g.element.value,f.append(g.element.name,a);c.f="";c.data=f}else{var f="maf"+
(""+Math.random()).slice(2,18),k="--"+f+"\r\n",l="--"+f+"--\r\n",h=["\r\n"];for(d=0;d<b.data.length;d++)if(g=b.data[d],g.fileData.length)a.onExchangeError("file_exchange_impossible");else h.push('Content-Disposition: form-data; name="'+g.element.name+'"\r\n\r\n'+g.element.value+"\r\n");c.f=f;c.data=h.join(k)+l}return c}}(window.makeAjaxForm),function(a){a.j=function(b,a){var c={onDataCollected:"function",onValidationError:"function",onStartExchange:"function",onExchangeError:"function",onExchangeSuccess:"function"},
f={},d;for(d in b)b.hasOwnProperty(d)&&(f[d]=d in c?d in a&&typeof a[d]===c[d]?a[d]:b[d]:d in a?a[d]:b[d]);return f};a.c=function(b,a){return{element:b,type:a}};a.b=function(b){return{element:b,fileData:b.files||[]}};a.o=function(b,a){if(b.addEventListener)b.addEventListener("click",a);else if(b.attachEvent){var c=a;a.handleEvent&&(c=function(){a.handleEvent.call(a)});b.attachEvent("onclick",c)}}}(window.makeAjaxForm),function(a){a.l=function(a,e){return!1===e.onDataCollected(a)?!1:0<a.validationErrors.length&&
e.s?(e.onValidationError(a.validationErrors),!1):!1===e.onStartExchange()?!1:a.data.length?!0:(e.onValidationError(["no_valid_data"]),!1)}}(window.makeAjaxForm),function(a){a.u=function(){var b=new XMLHttpRequest,e=this.m,c=a.h(e);if(a.l(c,e)){var f=setTimeout(function(){b.abort();e.onExchangeError("No server response for a long times. Exchange aborted.")},1E3*e.v);b.open("post",e.target,!0);b.onreadystatechange=function(){if(4===b.readyState)if(clearTimeout(f),200===b.status)e.onExchangeSuccess(b.responseText);
else e.onExchangeError(b.status+": "+b.statusText)};c=a.i(c,e);c.f.length&&b.setRequestHeader("Content-Type","multipart/form-data; boundary="+c.f);b.send(c.data)}}}(window.makeAjaxForm)}catch(a){console.dir(a)};
